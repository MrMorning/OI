
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problem - 156E - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />
    <HEAD><!--CombineResourcesFilter-->
    <LINK href="../../../../stat.codeforces.ru/favicon.png" rel="shortcut icon" type="image/png"/>
    <LINK href="../../../../stat.codeforces.ru/css/prettify.css" rel="stylesheet" type="text/css"/>
    <LINK charset="utf-8" href="../../../../codeforces.ru/static/combine/81d5459d81d074fc8d55b62d42856e2f_afb7247773e175c6194b5a4dbff89aeb.css" rel="stylesheet" type="text/css"/>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <LINK href="../../../../stat.codeforces.ru/markitup/skins/markitup/style.css" rel="stylesheet" type="text/css"/>
    <LINK href="../../../../stat.codeforces.ru/markitup/sets/markdown/style.css" rel="stylesheet" type="text/css"/>

    <SCRIPT charset="utf-8" src="../../../../yandex.st/share/share.js" type="text/javascript"> </SCRIPT>
    <LINK charset="utf-8" href="../../../../codeforces.ru/static/combine/eeae61f38a42b29407204616d93d8e8_aa3a566ac2a84e49a8e02f83d509fffe.css" rel="stylesheet" type="text/css"/>
    

    <!--[if IE]>
        <style>
            #sidebar {
                padding-left: 1em;
                margin: 1em 1em 1em 0;
            }
        </style>
    <![endif]-->
    
    <SCRIPT src="../../../../codeforces.ru/static/combine/92a6f5c66e500b5c1433eae7d3f371bb_5dc6637756ba9e44d6304b6267b72667.js" type="text/javascript"> </SCRIPT>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <!--/CombineResourcesFilter--></HEAD>
</head>
<body>


<!-- Copyright © 2008. Spidersoft Ltd -->
<style>
A.applink:hover {border: 2px dotted #DCE6F4;padding:2px;background-color:#ffff00;color:green;text-decoration:none}
A.applink       {border: 2px dotted #DCE6F4;padding:2px;color:#2F5BFF;background:transparent;text-decoration:none}
A.info          {color:#2F5BFF;background:transparent;text-decoration:none}
A.info:hover    {color:green;background:transparent;text-decoration:underline}
</style>
<div style='BORDER: 1px solid #DCE6F4; MARGIN-TOP: 20px; MARGIN-BOTTOM: 20px; MARGIN-LEFT: 5px; MARGIN-RIGHT: 5px; PADDING: 5px; BACKGROUND-COLOR: #eef8ff;line-height:180%; COLOR: #000000; font-family: Arial; font-size: 8pt; width=100%; FILTER: progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr="#FFFFFFFF", EndColorStr="#F2F5FAFF");'>
This page was saved using <a class="applink" href="http://www.spidersoft.com"><b>WebZIP 7.1.2.1052</b></a> <a class="applink" href="http://www.spidersoft.com"><b>offline browser</b></a>  (Unregistered) on  11/09/12 16:28:26.<br>
<b>Address:</b> <a class="info" href="http://codeforces.com/problemset/problem/156/E">http://codeforces.com/problemset/problem/156/E</a><br>
<b>Title:</b> Problem - 156E - Codeforces &nbsp;&bull;&nbsp; <b>Size:</b> 22501<br></div>
<!-- /Copyright © 2008. Spidersoft Ltd -->


<!-- Codeforces javascripts. -->

    <script type="text/javascript">
        $(document).ready(function() {
    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8" });
    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">

<div id="header" style="position:relative;">
    <div style="float:left;">
            <a href="http://codeforces.com/"><img src="../../../../stat.codeforces.ru/images/codeforces-logo-with-upper-beta.png"/></a>
            <div style="position:absolute;left:147px;top:41px;">
                <a href="http://vk.com/" class="logo-href">Sponsored by <img style="position:relative;top:2px;" src="../../../../stat.codeforces.ru/images/vkontakte-tiny-en.png"/></a>
            </div>
    </div>
    <div class="lang-chooser">
        <div style="text-align: right;">
            <a href="http://codeforces.com/problemset/problem/156/?locale=en"><img src="../../../../stat.codeforces.ru/images/flags/24/gb.png" title="In English" alt="In English"/></a>
            <a href="http://codeforces.com/problemset/problem/156/?locale=ru"><img src="../../../../stat.codeforces.ru/images/flags/24/ru.png" title="ÐŸÐ¾-Ñ€ÑƒÑÑÐºÐ¸" alt="ÐŸÐ¾-Ñ€ÑƒÑÑÐºÐ¸"/></a>
        </div>
        <div>
                <a href="http://codeforces.com/enter">Enter</a>
                 | 
                <a href="http://codeforces.com/register">Register</a>
                
        </div>
    </div>
    <div style="font-size:0.8em;margin-top:0.25em;position:absolute;right:0;top:4.25em;">
    </div>
    <br style="clear: both;"/>
</div>

    <div class="roundbox menu-box" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
            <div class="menu-list-container">

<ul class="menu-list">
        <li class=""><a href="http://codeforces.com/">Home</a></li>
        <li class=""><a href="http://codeforces.com/contests">Contests</a></li>
        <li class=""><a href="http://codeforces.com/gyms">Gym</a></li>
        <li class="current"><a href="http://codeforces.com/problemset">Problemset</a></li>
        <li class=""><a href="http://codeforces.com/ratings">Rating</a></li>
        <li class=""><a href="http://codeforces.com/help">FAQ</a></li>
        <li class=""><a href="http://codeforces.com/croc2012">CROC 2012 <img class="icon" src="../../../../stat.codeforces.ru/images/icons/cup.png"/></a></li>
        <li class=""><a href="http://codeforces.com/bayan201213">Bayan 2012/13 <img class="icon" src="../../../../stat.codeforces.ru/images/icons/cup.png"/></a></li>
        <li class=""><a href="http://codeforces.com/croc-bmstu-2012">CROC-MBTU 2012 <img class="icon" src="../../../../stat.codeforces.ru/images/icons/cup.png"/></a></li>
</ul>
                <form action="/search">
                    <input class="search" name="query" value="Search by tag..."/>
                </form>
                <br style="clear: both;"/>
            </div>
    </div>
    <script type="text/javascript">
        $(document).ready(function() {
            $("input.search").focus(function() {
                var val = $(this).val();
                if (val.indexOf("...") > 0) {
                    $(this).val("");
                }
            });
        });
    </script>
        <br style="height:3em; clear: both;"/>
        <div style="position: relative;">
                <div id="sidebar">

    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <table class="rtable">
            <tbody>
                <tr>
                            <th class="left" style="width:100%;">Codeforces Round #110 (Div. 1)</th>
                </tr>
                    <tr>
                                <td class="left  dark" colspan="1"><span class='contest-state-phase'>Finished</span></td>
                    </tr>
                    <tr>
                                <td class="left bottom" colspan="1"><span class='contest-state-regular countdown' home='http://stat.codeforces.ru' noRedirection='true' textBeforeRedirect=''><center>
</center></span></td>
                    </tr>
            </tbody>
        </table>
    </div>


    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">&rarr; Problem tags
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
    <div class="roundbox " style="margin:2px; padding:0 3px 2px 3px; background-color:#f0f0f0;float:left;">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<span class="tag-box" style="font-size:12px;" title="Dynamic programming">
    dp
</span>
    </div>
    <div style="clear:both;text-align:right;font-size:11px;">
            <span title="Please login into the Codeforces" class="notice">No tag edit access</span>
    </div>
</div>
    </div>

<form id="addTagForm" action="/data/problemTags" method="post" style="display:none;">
    <input name="action" type="hidden" value="addTag"/>
    <input name="problemId" type="hidden" value="963"/>
    <input name="tagName" type="hidden" value=""/>
</form>

<form id="removeTagForm" action="/data/problemTags" method="post" style="display:none;">
    <input name="action" type="hidden" value="removeTag"/>
    <input name="problemId" type="hidden" value="963"/>
    <input name="tagName" type="hidden" value=""/>
</form>

<script type="text/javascript">
    $(".tag-box img").click(function () {
        var tagName = $(this).attr("value");
        Codeforces.confirm("Are you sure you want to remove this tag?", function () {
            $("#removeTagForm input[name=tagName]").val(tagName);
            $("#removeTagForm").submit();
        }, function () {
        }, "Yes", "No");
    });

    $("#addTagLink").click(function () {
        $(this).hide();
        $("#addTagLabel").show();
        return false;
    });

    $("#addTagSelect").change(function () {
        var tagName = $(this).val();
        if (tagName === "") {
            $("#addTagLabel").hide();
            $("#addTagLink").show();
        } else {
            $("#addTagForm input[name=tagName]").val(tagName);
            $("#addTagForm").submit();
        }
    });
</script>

<style type="text/css">
#new-resource-form tr td {
padding-top: 0.5em;
}
#new-resource-form input:not([type="submit"]) {
font-size: 0.8em;
}
#new-resource-form select {
font-size: 0.8em;
}
</style>
<div class="roundbox sidebox sidebar-menu" style="">
<div class="roundbox-lt">&nbsp;</div>
<div class="roundbox-rt">&nbsp;</div>
<div class="caption titled">&rarr; Contest materials
<div class="top-links">
</div>
</div>
<ul>
<li>
<span>
<a href="http://codeforces.com/blog/entry/3994" title="" target="_blank">Announcement</a>
</span>
<span style="float: right;">
<img class="delete-resource-link" resourceId="1147" resourceName=""
resourceManual="true" src="../../../../stat.codeforces.ru/images/icons/close-10x10.png"
style="position: relative;bottom: -1px;left: 1px;cursor: pointer;"/>
</span>
<div style="clear: both;"></div>
</li>
</ul>
</div>                </div>
                <div id="content" class="content-with-sidebar">
                <div class="second-level-menu">
<ul class="second-level-menu-list">
    <li class="current"><a href="http://codeforces.com/problemset">Problems</a></li>
    <li><a href="http://codeforces.com/problemset/submit">Submit</a></li>
    <li><a href="http://codeforces.com/problemset/status">Status</a></li>
    <li><a href="http://codeforces.com/problemset/standings">Standings</a></li>
    <li><a href="http://codeforces.com/problemset/customtest">Custom test</a></li>
</ul>
</div>

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Mrs. Hudson's Pancakes</div><div class="time-limit"><div class="property-title">time limit per test</div>5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Mrs. Hudson hasn't made her famous pancakes for quite a while and finally she decided to make them again. She has learned <span class="tex-span"><i>m</i></span> new recipes recently and she can't wait to try them. Those recipes are based on <span class="tex-span"><i>n</i></span> special spices. Mrs. Hudson has these spices in the kitchen lying in jars <span class="tex-font-style-bf">numbered</span> with integers from <span class="tex-span">0</span> to <span class="tex-span"><i>n</i>â€‰-â€‰1</span> (each spice lies in an individual jar). Each jar also has the <span class="tex-font-style-bf">price</span> of the corresponding spice inscribed â€” some integer <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>.</p><p>We know three values for the <span class="tex-span"><i>i</i></span>-th pancake recipe: <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>. Here <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> are integers, and <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> is the <span class="tex-font-style-it">pattern</span> of some integer written in the numeral system with radix <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>. The pattern contains digits, Latin letters (to denote digits larger than nine) and question marks. Number <span class="tex-span"><i>x</i></span> in the <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>-base numeral system <span class="tex-font-style-it">matches the pattern</span> <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>, if we can replace question marks in the pattern with digits and letters so that we obtain number <span class="tex-span"><i>x</i></span> (leading zeroes aren't taken into consideration when performing the comparison). More formally: each question mark should be replaced by exactly one digit or exactly one letter. If after we replace all question marks we get a number with leading zeroes, we can delete these zeroes. For example, number <span class="tex-font-style-tt">40A9875</span> in the <span class="tex-span">11</span>-base numeral system matches the pattern &quot;<span class="tex-font-style-tt">??4??987?</span>&quot;, and number <span class="tex-font-style-tt">4A9875</span> does not.</p><p>To make the pancakes by the <span class="tex-span"><i>i</i></span>-th recipe, Mrs. Hudson should take all jars with <span class="tex-font-style-bf">numbers</span> whose representation in the <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>-base numeral system matches the pattern <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>. The <span class="tex-font-style-it">control number</span> of the recipe (<span class="tex-span"><i>z</i><sub class="lower-index"><i>i</i></sub></span>) is defined as the sum of number <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> and the product of <span class="tex-font-style-bf">prices</span> of all taken jars. More formally: <img align="middle" class="tex-formula" src="../../../../codeforces.ru/renderer/86ea62c3906295d11ece4457098162f25554cfce.png" /> (where <span class="tex-span"><i>j</i></span> is all such numbers whose representation in the <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>-base numeral system matches the pattern <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>).</p><p>Mrs. Hudson isn't as interested in the control numbers as she is in their minimum prime divisors. Your task is: for each recipe <span class="tex-span"><i>i</i></span> find the minimum prime divisor of number <span class="tex-span"><i>z</i><sub class="lower-index"><i>i</i></sub></span>. If this divisor exceeds <span class="tex-span">100</span>, then you do not have to find it, print -1.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains the single integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1â€‰â‰¤â€‰<i>n</i>â€‰â‰¤â€‰10<sup class="upper-index">4</sup></span>). The second line contains space-separated prices of the spices <span class="tex-span"><i>a</i><sub class="lower-index">0</sub>,â€‰<i>a</i><sub class="lower-index">1</sub>,â€‰...,â€‰<i>a</i><sub class="lower-index"><i>n</i>â€‰-â€‰1</sub></span>, where <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> is an integer (<span class="tex-span">1â€‰â‰¤â€‰<i>a</i><sub class="lower-index"><i>i</i></sub>â€‰â‰¤â€‰10<sup class="upper-index">18</sup></span>).</p><p>The third line contains the single integer <span class="tex-span"><i>m</i></span> (<span class="tex-span">1â€‰â‰¤â€‰<i>m</i>â€‰â‰¤â€‰3Â·10<sup class="upper-index">4</sup></span>) â€” the number of recipes Mrs. Hudson has learned. </p><p>Next <span class="tex-span"><i>m</i></span> lines describe the recipes, one per line. First you are given an integer <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>, written in the decimal numeral system (<span class="tex-span">2â€‰â‰¤â€‰<i>d</i><sub class="lower-index"><i>i</i></sub>â€‰â‰¤â€‰16</span>). Then after a space follows the <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> pattern â€” a string from <span class="tex-span">1</span> to <span class="tex-span">30</span> in length, inclusive, consisting of digits from &quot;<span class="tex-font-style-tt">0</span>&quot; to &quot;<span class="tex-font-style-tt">9</span>&quot;, letters from &quot;<span class="tex-font-style-tt">A</span>&quot; to &quot;<span class="tex-font-style-tt">F</span>&quot; and signs &quot;<span class="tex-font-style-tt">?</span>&quot;. Letters from &quot;<span class="tex-font-style-tt">A</span>&quot; to &quot;<span class="tex-font-style-tt">F</span>&quot; should be considered as digits from <span class="tex-span">10</span> to <span class="tex-span">15</span> correspondingly. It is guaranteed that all digits of the pattern (including the digits that are represented by letters) are strictly less than <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>. Then after a space follows an integer <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>, written in the decimal numeral system (<span class="tex-span">1â€‰â‰¤â€‰<i>c</i><sub class="lower-index"><i>i</i></sub>â€‰â‰¤â€‰10<sup class="upper-index">18</sup></span>).</p><p>Please do not use the <span class="tex-font-style-tt">%lld</span> specificator to read or write 64-bit integers in Ð¡++, in is preferred to use <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span>, strings or the <span class="tex-font-style-tt">%I64d</span> specificator instead.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each recipe count by what minimum prime number the control number is divided and print this prime number on the single line. If this number turns out larger than <span class="tex-span">100</span>, print -1.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>1<br />1<br />1<br />2 ? 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>2<br /></pre></div><div class="input"><div class="title">Input</div><pre>4<br />2 3 5 7<br />4<br />2 ?0 11<br />2 ?1 13<br />2 0? 17<br />2 1? 19<br /></pre></div><div class="output"><div class="title">Output</div><pre>3<br />2<br />23<br />2<br /></pre></div><div class="input"><div class="title">Input</div><pre>1<br />1000000000000000000<br />1<br />16 ?????????????? 1<br /></pre></div><div class="output"><div class="title">Output</div><pre>-1<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first test any one-digit number in the binary system matches. The jar is only one and its price is equal to <span class="tex-span">1</span>, the number <span class="tex-span"><i>c</i></span> is also equal to <span class="tex-span">1</span>, the control number equals <span class="tex-span">2</span>. The minimal prime divisor of <span class="tex-span">2</span> is <span class="tex-span">2</span>.</p><p>In the second test there are <span class="tex-span">4</span> jars with numbers from <span class="tex-span">0</span> to <span class="tex-span">3</span>, and the prices are equal <span class="tex-span">2</span>, <span class="tex-span">3</span>, <span class="tex-span">5</span> and <span class="tex-span">7</span> correspondingly â€” the first four prime numbers. In all recipes numbers should be two-digit. In the first recipe the second digit always is <span class="tex-span">0</span>, in the second recipe the second digit always is <span class="tex-span">1</span>, in the third recipe the first digit must be <span class="tex-span">0</span>, in the fourth recipe the first digit always is <span class="tex-span">1</span>. Consequently, the control numbers â€‹â€‹are as follows: in the first recipe <span class="tex-span">2â€‰Ã—â€‰5â€‰+â€‰11â€‰=â€‰21</span> (the minimum prime divisor is <span class="tex-span">3</span>), in the second recipe <span class="tex-span">3â€‰Ã—â€‰7â€‰+â€‰13â€‰=â€‰44</span> (the minimum prime divisor is <span class="tex-span">2</span>), in the third recipe <span class="tex-span">2â€‰Ã—â€‰3â€‰+â€‰17â€‰=â€‰23</span> (the minimum prime divisor is <span class="tex-span">23</span>) and, finally, in the fourth recipe <span class="tex-span">5â€‰Ã—â€‰7â€‰+â€‰19â€‰=â€‰54</span> (the minimum prime divisor is <span class="tex-span">2</span>).</p><p>In the third test, the number should consist of fourteen digits and be recorded in a sixteen-base numeral system. Number <span class="tex-span">0</span> (the number of the single bottles) matches, the control number will be equal to <span class="tex-span">10<sup class="upper-index">18</sup>â€‰+â€‰1</span>. The minimum prime divisor of this number is equal to <span class="tex-span">101</span> and you should print -1.</p></div></div></div>            </div>
        </div>
          <br style="clear:both;"/> 
          <div id="footer">
               <div><a href="http://codeforces.com/">Codeforces</a> (c) Copyright 2010-2012 Mike Mirzayanov</div>
               <div>The only programming contests Web 2.0 platform</div>
               
               <div>Server time: 11/09/2012 12:27PM.</div>
          </div>
    <script type="text/javascript">
        $(document).ready(function() {
            Codeforces.focusOnError();
        });
    </script>
</div>    
</body>                                       
</html>                                       
