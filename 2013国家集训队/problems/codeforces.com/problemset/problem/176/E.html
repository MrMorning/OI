
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problem - 176E - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />
    <HEAD><!--CombineResourcesFilter-->
    <LINK href="../../../../stat.codeforces.ru/favicon.png" rel="shortcut icon" type="image/png"/>
    <LINK href="../../../../stat.codeforces.ru/css/prettify.css" rel="stylesheet" type="text/css"/>
    <LINK charset="utf-8" href="../../../../codeforces.ru/static/combine/81d5459d81d074fc8d55b62d42856e2f_afb7247773e175c6194b5a4dbff89aeb.css" rel="stylesheet" type="text/css"/>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <LINK href="../../../../stat.codeforces.ru/markitup/skins/markitup/style.css" rel="stylesheet" type="text/css"/>
    <LINK href="../../../../stat.codeforces.ru/markitup/sets/markdown/style.css" rel="stylesheet" type="text/css"/>

    <SCRIPT charset="utf-8" src="../../../../yandex.st/share/share.js" type="text/javascript"> </SCRIPT>
    <LINK charset="utf-8" href="../../../../codeforces.ru/static/combine/eeae61f38a42b29407204616d93d8e8_aa3a566ac2a84e49a8e02f83d509fffe.css" rel="stylesheet" type="text/css"/>
    

    <!--[if IE]>
        <style>
            #sidebar {
                padding-left: 1em;
                margin: 1em 1em 1em 0;
            }
        </style>
    <![endif]-->
    
    <SCRIPT src="../../../../codeforces.ru/static/combine/92a6f5c66e500b5c1433eae7d3f371bb_5dc6637756ba9e44d6304b6267b72667.js" type="text/javascript"> </SCRIPT>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <!--/CombineResourcesFilter--></HEAD>
</head>
<body>


<!-- Copyright © 2008. Spidersoft Ltd -->
<style>
A.applink:hover {border: 2px dotted #DCE6F4;padding:2px;background-color:#ffff00;color:green;text-decoration:none}
A.applink       {border: 2px dotted #DCE6F4;padding:2px;color:#2F5BFF;background:transparent;text-decoration:none}
A.info          {color:#2F5BFF;background:transparent;text-decoration:none}
A.info:hover    {color:green;background:transparent;text-decoration:underline}
</style>
<div style='BORDER: 1px solid #DCE6F4; MARGIN-TOP: 20px; MARGIN-BOTTOM: 20px; MARGIN-LEFT: 5px; MARGIN-RIGHT: 5px; PADDING: 5px; BACKGROUND-COLOR: #eef8ff;line-height:180%; COLOR: #000000; font-family: Arial; font-size: 8pt; width=100%; FILTER: progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr="#FFFFFFFF", EndColorStr="#F2F5FAFF");'>
This page was saved using <a class="applink" href="http://www.spidersoft.com"><b>WebZIP 7.1.2.1052</b></a> <a class="applink" href="http://www.spidersoft.com"><b>offline browser</b></a>  (Unregistered) on  11/09/12 16:28:26.<br>
<b>Address:</b> <a class="info" href="http://codeforces.com/problemset/problem/176/E">http://codeforces.com/problemset/problem/176/E</a><br>
<b>Title:</b> Problem - 176E - Codeforces &nbsp;&bull;&nbsp; <b>Size:</b> 18776<br></div>
<!-- /Copyright © 2008. Spidersoft Ltd -->


<!-- Codeforces javascripts. -->

    <script type="text/javascript">
        $(document).ready(function() {
    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8" });
    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">

<div id="header" style="position:relative;">
    <div style="float:left;">
            <div style="padding:1em 0 0 2px;color:#00a651;">
<a href="http://codeforces.com/croc2012"><img src="../../../images/custom/croc-en.gif"/></a>
<span style="padding:1.5em;">Open Moscow Programming Championship</span>
</div>
    </div>
    <div class="lang-chooser">
        <div style="text-align: right;">
            <a href="http://codeforces.com/problemset/problem/176/?locale=en"><img src="../../../../stat.codeforces.ru/images/flags/24/gb.png" title="In English" alt="In English"/></a>
            <a href="http://codeforces.com/problemset/problem/176/?locale=ru"><img src="../../../../stat.codeforces.ru/images/flags/24/ru.png" title="ÐŸÐ¾-Ñ€ÑƒÑÑÐºÐ¸" alt="ÐŸÐ¾-Ñ€ÑƒÑÑÐºÐ¸"/></a>
        </div>
        <div>
                <a href="http://codeforces.com/enter">Enter</a>
                 | 
                <a href="http://codeforces.com/register">Register</a>
                
        </div>
    </div>
    <div style="font-size:0.8em;margin-top:0.25em;position:absolute;right:0;top:4.25em;">
    </div>
    <br style="clear: both;"/>
</div>

    <div class="roundbox menu-box" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
            <div class="menu-list-container">

<ul class="menu-list">
        <li class=""><a href="http://codeforces.com/">Home</a></li>
        <li class=""><a href="http://codeforces.com/contests">Contests</a></li>
        <li class=""><a href="http://codeforces.com/gyms">Gym</a></li>
        <li class="current"><a href="http://codeforces.com/problemset">Problemset</a></li>
        <li class=""><a href="http://codeforces.com/ratings">Rating</a></li>
        <li class=""><a href="http://codeforces.com/help">FAQ</a></li>
        <li class=""><a href="http://codeforces.com/croc2012">CROC 2012 <img class="icon" src="../../../../stat.codeforces.ru/images/icons/cup.png"/></a></li>
        <li class=""><a href="http://codeforces.com/bayan201213">Bayan 2012/13 <img class="icon" src="../../../../stat.codeforces.ru/images/icons/cup.png"/></a></li>
        <li class=""><a href="http://codeforces.com/croc-bmstu-2012">CROC-MBTU 2012 <img class="icon" src="../../../../stat.codeforces.ru/images/icons/cup.png"/></a></li>
</ul>
                <form action="/search">
                    <input class="search" name="query" value="Search by tag..."/>
                </form>
                <br style="clear: both;"/>
            </div>
    </div>
    <script type="text/javascript">
        $(document).ready(function() {
            $("input.search").focus(function() {
                var val = $(this).val();
                if (val.indexOf("...") > 0) {
                    $(this).val("");
                }
            });
        });
    </script>
        <br style="height:3em; clear: both;"/>
        <div style="position: relative;">
                <div id="sidebar">

    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <table class="rtable">
            <tbody>
                <tr>
                            <th class="left" style="width:100%;">Croc Champ 2012 - Round 2</th>
                </tr>
                    <tr>
                                <td class="left  dark" colspan="1"><span class='contest-state-phase'>Finished</span></td>
                    </tr>
                    <tr>
                                <td class="left bottom" colspan="1"><span class='contest-state-regular countdown' home='http://stat.codeforces.ru' noRedirection='true' textBeforeRedirect=''><center>
</center></span></td>
                    </tr>
            </tbody>
        </table>
    </div>


    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">&rarr; Problem tags
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
    <div class="roundbox " style="margin:2px; padding:0 3px 2px 3px; background-color:#f0f0f0;float:left;">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<span class="tag-box" style="font-size:12px;" title="Heaps, binary search trees, segment trees, hash tables, etc">
    data structures
</span>
    </div>
    <div class="roundbox " style="margin:2px; padding:0 3px 2px 3px; background-color:#f0f0f0;float:left;">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<span class="tag-box" style="font-size:12px;" title="Dfs and similar">
    dfs and similar
</span>
    </div>
    <div class="roundbox " style="margin:2px; padding:0 3px 2px 3px; background-color:#f0f0f0;float:left;">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<span class="tag-box" style="font-size:12px;" title="Trees">
    trees
</span>
    </div>
    <div style="clear:both;text-align:right;font-size:11px;">
            <span title="Please login into the Codeforces" class="notice">No tag edit access</span>
    </div>
</div>
    </div>

<form id="addTagForm" action="/data/problemTags" method="post" style="display:none;">
    <input name="action" type="hidden" value="addTag"/>
    <input name="problemId" type="hidden" value="1245"/>
    <input name="tagName" type="hidden" value=""/>
</form>

<form id="removeTagForm" action="/data/problemTags" method="post" style="display:none;">
    <input name="action" type="hidden" value="removeTag"/>
    <input name="problemId" type="hidden" value="1245"/>
    <input name="tagName" type="hidden" value=""/>
</form>

<script type="text/javascript">
    $(".tag-box img").click(function () {
        var tagName = $(this).attr("value");
        Codeforces.confirm("Are you sure you want to remove this tag?", function () {
            $("#removeTagForm input[name=tagName]").val(tagName);
            $("#removeTagForm").submit();
        }, function () {
        }, "Yes", "No");
    });

    $("#addTagLink").click(function () {
        $(this).hide();
        $("#addTagLabel").show();
        return false;
    });

    $("#addTagSelect").change(function () {
        var tagName = $(this).val();
        if (tagName === "") {
            $("#addTagLabel").hide();
            $("#addTagLink").show();
        } else {
            $("#addTagForm input[name=tagName]").val(tagName);
            $("#addTagForm").submit();
        }
    });
</script>

<style type="text/css">
#new-resource-form tr td {
padding-top: 0.5em;
}
#new-resource-form input:not([type="submit"]) {
font-size: 0.8em;
}
#new-resource-form select {
font-size: 0.8em;
}
</style>
<div class="roundbox sidebox sidebar-menu" style="">
<div class="roundbox-lt">&nbsp;</div>
<div class="roundbox-rt">&nbsp;</div>
<div class="caption titled">&rarr; Contest materials
<div class="top-links">
</div>
</div>
<ul>
<li>
<span>
<a href="http://codeforces.com/blog/entry/4370" title="Croc Champ 2012 â€” Round 2" target="_blank">Announcement</a>
</span>
<span style="float: right;">
<img class="delete-resource-link" resourceId="671" resourceName="Croc Champ 2012 â€” Round 2"
resourceManual="true" src="../../../../stat.codeforces.ru/images/icons/close-10x10.png"
style="position: relative;bottom: -1px;left: 1px;cursor: pointer;"/>
</span>
<div style="clear: both;"></div>
</li>
<li>
<span>
<a href="http://codeforces.com/blog/entry/4372" title="Croc Champ 2012 â€” Round 2 â€” Editorial" target="_blank">Tutorial</a>
</span>
<span style="float: right;">
<img class="delete-resource-link" resourceId="673" resourceName="Croc Champ 2012 â€” Round 2 â€” Editorial"
resourceManual="true" src="../../../../stat.codeforces.ru/images/icons/close-10x10.png"
style="position: relative;bottom: -1px;left: 1px;cursor: pointer;"/>
</span>
<div style="clear: both;"></div>
</li>
</ul>
</div>                </div>
                <div id="content" class="content-with-sidebar">
                <div class="second-level-menu">
<ul class="second-level-menu-list">
    <li class="current"><a href="http://codeforces.com/problemset">Problems</a></li>
    <li><a href="http://codeforces.com/problemset/submit">Submit</a></li>
    <li><a href="http://codeforces.com/problemset/status">Status</a></li>
    <li><a href="http://codeforces.com/problemset/standings">Standings</a></li>
    <li><a href="http://codeforces.com/problemset/customtest">Custom test</a></li>
</ul>
</div>

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Archaeology</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>This time you should help a team of researchers on an island in the Pacific Ocean. They research the culture of the ancient tribes that used to inhabit the island many years ago.</p><p>Overall they've dug out <span class="tex-span"><i>n</i></span> villages. Some pairs of villages were connected by roads. People could go on the roads in both directions. Overall there were exactly <span class="tex-span"><i>n</i>â€‰-â€‰1</span> roads, and from any village one could get to any other one.</p><p>The tribes were not peaceful and they had many wars. As a result of the wars, some villages were destroyed completely. During more peaceful years some of the villages were restored.</p><p>At each moment of time people <span class="tex-font-style-it">used</span> only those roads that belonged to some shortest way between two villages <span class="tex-font-style-it">that existed at the given moment</span>. In other words, people used the minimum subset of roads in such a way, that it was possible to get from any existing village to any other existing one. Note that throughout the island's whole history, there existed exactly <span class="tex-span"><i>n</i>â€‰-â€‰1</span> roads that have been found by the researchers. There never were any other roads.</p><p>The researchers think that observing the total sum of used roadsâ€™ lengths at different moments of time can help to better understand the tribes' culture and answer several historical questions.</p><p>You will be given the full history of the tribes' existence. Your task is to determine the total length of used roads at some moments of time.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains an integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1â€‰â‰¤â€‰<i>n</i>â€‰â‰¤â€‰10<sup class="upper-index">5</sup></span>) â€” the number of villages. The next <span class="tex-span"><i>n</i>â€‰-â€‰1</span> lines describe the roads. The <span class="tex-span"><i>i</i></span>-th of these lines contains three integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1â€‰â‰¤â€‰<i>a</i><sub class="lower-index"><i>i</i></sub>,â€‰<i>b</i><sub class="lower-index"><i>i</i></sub>â€‰â‰¤â€‰<i>n</i></span>, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>â€‰â‰ â€‰<i>b</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span">1â€‰â‰¤â€‰<i>c</i><sub class="lower-index"><i>i</i></sub>â€‰â‰¤â€‰10<sup class="upper-index">9</sup></span>, <span class="tex-span">1â€‰â‰¤â€‰<i>i</i>â€‰&lt;â€‰<i>n</i></span>) â€” the numbers of villages that are connected by the <span class="tex-span"><i>i</i></span>-th road and the road's length. The numbers in the lines are separated by a space.</p><p>The next line contains an integer <span class="tex-span"><i>q</i></span> (<span class="tex-span">1â€‰â‰¤â€‰<i>q</i>â€‰â‰¤â€‰10<sup class="upper-index">5</sup></span>) â€” the number of queries. Then follow <span class="tex-span"><i>q</i></span> queries, one per line, ordered by time. Each query belongs to one of three types:</p><p><ul></ul></p><p><li> &quot;<span class="tex-font-style-tt">+ </span><span class="tex-span"><i>x</i></span>&quot; â€” village number <span class="tex-span"><i>x</i></span> is restored (<span class="tex-span">1â€‰â‰¤â€‰<i>x</i>â€‰â‰¤â€‰<i>n</i></span>). </li><li> &quot;<span class="tex-font-style-tt">- </span><span class="tex-span"><i>x</i></span>&quot; â€” village number <span class="tex-span"><i>x</i></span> is destroyed (<span class="tex-span">1â€‰â‰¤â€‰<i>x</i>â€‰â‰¤â€‰<i>n</i></span>). </li><li> &quot;<span class="tex-font-style-tt">?</span>&quot; â€” the archaeologists want to know the total length of the roads which were used for that time period.</li></p><p>It is guaranteed that the queries do not contradict each other, that is, there won't be queries to destroy non-existing villages or restore the already existing ones. It is guaranteed that we have at least one query of type &quot;<span class="tex-font-style-tt">?</span>&quot;. It is also guaranteed that one can get from any village to any other one by the given roads.</p><p>At the initial moment of time no village is considered to exist.</p></div><div class="output-specification"><div class="section-title">Output</div><p>For each query of type &quot;<span class="tex-font-style-tt">?</span>&quot; print the total length of used roads on a single line. You should print the answers to the queries in the order, in which they are given in the input.</p><p>Please do not use the <span class="tex-font-style-tt">%lld</span> specifier to read or write 64-bit integers in Ð¡++. It is preferred to use <span class="tex-font-style-tt">cin</span>, <span class="tex-font-style-tt">cout</span> streams or the <span class="tex-font-style-tt">%I64d</span> specifier.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>6<br />1 2 1<br />1 3 5<br />4 1 7<br />4 5 3<br />6 4 2<br />10<br />+ 3<br />+ 1<br />?<br />+ 6<br />?<br />+ 5<br />?<br />- 6<br />- 3<br />?<br /></pre></div><div class="output"><div class="title">Output</div><pre>5<br />14<br />17<br />10<br /></pre></div></div></div></div></div>            </div>
        </div>
          <br style="clear:both;"/> 
          <div id="footer">
               <div><a href="http://codeforces.com/">Codeforces</a> (c) Copyright 2010-2012 Mike Mirzayanov</div>
               <div>The only programming contests Web 2.0 platform</div>
               
               <div>Server time: 11/09/2012 12:27PM.</div>
          </div>
    <script type="text/javascript">
        $(document).ready(function() {
            Codeforces.focusOnError();
        });
    </script>
</div>    
</body>                                       
</html>                                       
