
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90"/>    
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2" />
    <title>Problem - 83E - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community" />
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup" />
    <meta name="robots" content="index, follow" />
    <HEAD><!--CombineResourcesFilter-->
    <LINK href="../../../../stat.codeforces.ru/favicon.png" rel="shortcut icon" type="image/png"/>
    <LINK href="../../../../stat.codeforces.ru/css/prettify.css" rel="stylesheet" type="text/css"/>
    <LINK charset="utf-8" href="../../../../codeforces.ru/static/combine/81d5459d81d074fc8d55b62d42856e2f_afb7247773e175c6194b5a4dbff89aeb.css" rel="stylesheet" type="text/css"/>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <LINK href="../../../../stat.codeforces.ru/markitup/skins/markitup/style.css" rel="stylesheet" type="text/css"/>
    <LINK href="../../../../stat.codeforces.ru/markitup/sets/markdown/style.css" rel="stylesheet" type="text/css"/>

    <SCRIPT charset="utf-8" src="../../../../yandex.st/share/share.js" type="text/javascript"> </SCRIPT>
    <LINK charset="utf-8" href="../../../../codeforces.ru/static/combine/eeae61f38a42b29407204616d93d8e8_aa3a566ac2a84e49a8e02f83d509fffe.css" rel="stylesheet" type="text/css"/>
    

    <!--[if IE]>
        <style>
            #sidebar {
                padding-left: 1em;
                margin: 1em 1em 1em 0;
            }
        </style>
    <![endif]-->
    
    <SCRIPT src="../../../../codeforces.ru/static/combine/92a6f5c66e500b5c1433eae7d3f371bb_5dc6637756ba9e44d6304b6267b72667.js" type="text/javascript"> </SCRIPT>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <!--/CombineResourcesFilter--></HEAD>
</head>
<body>


<!-- Copyright © 2008. Spidersoft Ltd -->
<style>
A.applink:hover {border: 2px dotted #DCE6F4;padding:2px;background-color:#ffff00;color:green;text-decoration:none}
A.applink       {border: 2px dotted #DCE6F4;padding:2px;color:#2F5BFF;background:transparent;text-decoration:none}
A.info          {color:#2F5BFF;background:transparent;text-decoration:none}
A.info:hover    {color:green;background:transparent;text-decoration:underline}
</style>
<div style='BORDER: 1px solid #DCE6F4; MARGIN-TOP: 20px; MARGIN-BOTTOM: 20px; MARGIN-LEFT: 5px; MARGIN-RIGHT: 5px; PADDING: 5px; BACKGROUND-COLOR: #eef8ff;line-height:180%; COLOR: #000000; font-family: Arial; font-size: 8pt; width=100%; FILTER: progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr="#FFFFFFFF", EndColorStr="#F2F5FAFF");'>
This page was saved using <a class="applink" href="http://www.spidersoft.com"><b>WebZIP 7.1.2.1052</b></a> <a class="applink" href="http://www.spidersoft.com"><b>offline browser</b></a>  (Unregistered) on  11/09/12 16:28:26.<br>
<b>Address:</b> <a class="info" href="http://codeforces.com/problemset/problem/83/E">http://codeforces.com/problemset/problem/83/E</a><br>
<b>Title:</b> Problem - 83E - Codeforces &nbsp;&bull;&nbsp; <b>Size:</b> 18057<br></div>
<!-- /Copyright © 2008. Spidersoft Ltd -->


<!-- Codeforces javascripts. -->

    <script type="text/javascript">
        $(document).ready(function() {
    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8" });
    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">

<div id="header" style="position:relative;">
    <div style="float:left;">
            <a href="http://codeforces.com/"><img src="../../../../stat.codeforces.ru/images/codeforces-logo-with-upper-beta.png"/></a>
            <div style="position:absolute;left:147px;top:41px;">
                <a href="http://vk.com/" class="logo-href">Sponsored by <img style="position:relative;top:2px;" src="../../../../stat.codeforces.ru/images/vkontakte-tiny-en.png"/></a>
            </div>
    </div>
    <div class="lang-chooser">
        <div style="text-align: right;">
            <a href="http://codeforces.com/problemset/problem/83/?locale=en"><img src="../../../../stat.codeforces.ru/images/flags/24/gb.png" title="In English" alt="In English"/></a>
            <a href="http://codeforces.com/problemset/problem/83/?locale=ru"><img src="../../../../stat.codeforces.ru/images/flags/24/ru.png" title="ÐŸÐ¾-Ñ€ÑƒÑÑÐºÐ¸" alt="ÐŸÐ¾-Ñ€ÑƒÑÑÐºÐ¸"/></a>
        </div>
        <div>
                <a href="http://codeforces.com/enter">Enter</a>
                 | 
                <a href="http://codeforces.com/register">Register</a>
                
        </div>
    </div>
    <div style="font-size:0.8em;margin-top:0.25em;position:absolute;right:0;top:4.25em;">
    </div>
    <br style="clear: both;"/>
</div>

    <div class="roundbox menu-box" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
            <div class="menu-list-container">

<ul class="menu-list">
        <li class=""><a href="http://codeforces.com/">Home</a></li>
        <li class=""><a href="http://codeforces.com/contests">Contests</a></li>
        <li class=""><a href="http://codeforces.com/gyms">Gym</a></li>
        <li class="current"><a href="http://codeforces.com/problemset">Problemset</a></li>
        <li class=""><a href="http://codeforces.com/ratings">Rating</a></li>
        <li class=""><a href="http://codeforces.com/help">FAQ</a></li>
        <li class=""><a href="http://codeforces.com/croc2012">CROC 2012 <img class="icon" src="../../../../stat.codeforces.ru/images/icons/cup.png"/></a></li>
        <li class=""><a href="http://codeforces.com/bayan201213">Bayan 2012/13 <img class="icon" src="../../../../stat.codeforces.ru/images/icons/cup.png"/></a></li>
        <li class=""><a href="http://codeforces.com/croc-bmstu-2012">CROC-MBTU 2012 <img class="icon" src="../../../../stat.codeforces.ru/images/icons/cup.png"/></a></li>
</ul>
                <form action="/search">
                    <input class="search" name="query" value="Search by tag..."/>
                </form>
                <br style="clear: both;"/>
            </div>
    </div>
    <script type="text/javascript">
        $(document).ready(function() {
            $("input.search").focus(function() {
                var val = $(this).val();
                if (val.indexOf("...") > 0) {
                    $(this).val("");
                }
            });
        });
    </script>
        <br style="height:3em; clear: both;"/>
        <div style="position: relative;">
                <div id="sidebar">

    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <table class="rtable">
            <tbody>
                <tr>
                            <th class="left" style="width:100%;">Codeforces Beta Round #72 (Div. 1 Only)</th>
                </tr>
                    <tr>
                                <td class="left  dark" colspan="1"><span class='contest-state-phase'>Finished</span></td>
                    </tr>
                    <tr>
                                <td class="left bottom" colspan="1"><span class='contest-state-regular countdown' home='http://stat.codeforces.ru' noRedirection='true' textBeforeRedirect=''><center>
</center></span></td>
                    </tr>
            </tbody>
        </table>
    </div>


    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">&rarr; Problem tags
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
    <div class="roundbox " style="margin:2px; padding:0 3px 2px 3px; background-color:#f0f0f0;float:left;">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<span class="tag-box" style="font-size:12px;" title="Bitmasks">
    bitmasks
</span>
    </div>
    <div class="roundbox " style="margin:2px; padding:0 3px 2px 3px; background-color:#f0f0f0;float:left;">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<span class="tag-box" style="font-size:12px;" title="Dynamic programming">
    dp
</span>
    </div>
    <div style="clear:both;text-align:right;font-size:11px;">
            <span title="Please login into the Codeforces" class="notice">No tag edit access</span>
    </div>
</div>
    </div>

<form id="addTagForm" action="/data/problemTags" method="post" style="display:none;">
    <input name="action" type="hidden" value="addTag"/>
    <input name="problemId" type="hidden" value="446"/>
    <input name="tagName" type="hidden" value=""/>
</form>

<form id="removeTagForm" action="/data/problemTags" method="post" style="display:none;">
    <input name="action" type="hidden" value="removeTag"/>
    <input name="problemId" type="hidden" value="446"/>
    <input name="tagName" type="hidden" value=""/>
</form>

<script type="text/javascript">
    $(".tag-box img").click(function () {
        var tagName = $(this).attr("value");
        Codeforces.confirm("Are you sure you want to remove this tag?", function () {
            $("#removeTagForm input[name=tagName]").val(tagName);
            $("#removeTagForm").submit();
        }, function () {
        }, "Yes", "No");
    });

    $("#addTagLink").click(function () {
        $(this).hide();
        $("#addTagLabel").show();
        return false;
    });

    $("#addTagSelect").change(function () {
        var tagName = $(this).val();
        if (tagName === "") {
            $("#addTagLabel").hide();
            $("#addTagLink").show();
        } else {
            $("#addTagForm input[name=tagName]").val(tagName);
            $("#addTagForm").submit();
        }
    });
</script>

                </div>
                <div id="content" class="content-with-sidebar">
                <div class="second-level-menu">
<ul class="second-level-menu-list">
    <li class="current"><a href="http://codeforces.com/problemset">Problems</a></li>
    <li><a href="http://codeforces.com/problemset/submit">Submit</a></li>
    <li><a href="http://codeforces.com/problemset/status">Status</a></li>
    <li><a href="http://codeforces.com/problemset/standings">Standings</a></li>
    <li><a href="http://codeforces.com/problemset/customtest">Custom test</a></li>
</ul>
</div>

<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">E. Two Subsequences</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>On an IT lesson Valera studied data compression. The teacher told about a new method, which we shall now describe to you.</p><p>Let <span class="tex-span">{<i>a</i><sub class="lower-index">1</sub>,â€‰<i>a</i><sub class="lower-index">2</sub>,â€‰...,â€‰<i>a</i><sub class="lower-index"><i>n</i></sub>}</span> be the given sequence of lines needed to be compressed. Here and below we shall assume that all lines are <span class="tex-font-style-bf">of the same length</span> and consist only of the digits <span class="tex-span">0</span> and <span class="tex-span">1</span>. Let's define the compression function:</p><p><ul> <li> <span class="tex-span"><i>f</i>(</span>empty sequence<span class="tex-span">)â€‰=â€‰</span>empty string </li><li> <span class="tex-span"><i>f</i>(<i>s</i>)â€‰=â€‰<i>s</i></span>. </li><li> <span class="tex-span"><i>f</i>(<i>s</i><sub class="lower-index">1</sub>,â€‰<i>s</i><sub class="lower-index">2</sub>)â€‰=â€‰</span> the smallest in length string, which has one of the prefixes equal to <span class="tex-span"><i>s</i><sub class="lower-index">1</sub></span> and one of the suffixes equal to <span class="tex-span"><i>s</i><sub class="lower-index">2</sub></span>. For example, <span class="tex-span"><i>f</i>(001,â€‰011)â€‰=â€‰0011</span>, <span class="tex-span"><i>f</i>(111,â€‰011)â€‰=â€‰111011</span>. </li><li> <span class="tex-span"><i>f</i>(<i>a</i><sub class="lower-index">1</sub>,â€‰<i>a</i><sub class="lower-index">2</sub>,â€‰...,â€‰<i>a</i><sub class="lower-index"><i>n</i></sub>)â€‰=â€‰<i>f</i>(<i>f</i>(<i>a</i><sub class="lower-index">1</sub>,â€‰<i>a</i><sub class="lower-index">2</sub>,â€‰<i>a</i><sub class="lower-index"><i>n</i>â€‰-â€‰1</sub>),â€‰<i>a</i><sub class="lower-index"><i>n</i></sub>)</span>. For example, <span class="tex-span"><i>f</i>(000,â€‰000,â€‰111)â€‰=â€‰<i>f</i>(<i>f</i>(000,â€‰000),â€‰111)â€‰=â€‰<i>f</i>(000,â€‰111)â€‰=â€‰000111</span>. </li></ul></p><p>Valera faces a real challenge: he should divide the given sequence <span class="tex-span">{<i>a</i><sub class="lower-index">1</sub>,â€‰<i>a</i><sub class="lower-index">2</sub>,â€‰...,â€‰<i>a</i><sub class="lower-index"><i>n</i></sub>}</span> into two subsequences <span class="tex-span">{<i>b</i><sub class="lower-index">1</sub>,â€‰<i>b</i><sub class="lower-index">2</sub>,â€‰...,â€‰<i>b</i><sub class="lower-index"><i>k</i></sub>}</span> and <span class="tex-span">{<i>c</i><sub class="lower-index">1</sub>,â€‰<i>c</i><sub class="lower-index">2</sub>,â€‰...,â€‰<i>c</i><sub class="lower-index"><i>m</i></sub>}</span>, <span class="tex-span"><i>m</i>â€‰+â€‰<i>k</i>â€‰=â€‰<i>n</i></span>, so that the value of <span class="tex-span"><i>S</i>â€‰=â€‰|<i>f</i>(<i>b</i><sub class="lower-index">1</sub>,â€‰<i>b</i><sub class="lower-index">2</sub>,â€‰...,â€‰<i>b</i><sub class="lower-index"><i>k</i></sub>)|â€‰+â€‰|<i>f</i>(<i>c</i><sub class="lower-index">1</sub>,â€‰<i>c</i><sub class="lower-index">2</sub>,â€‰...,â€‰<i>c</i><sub class="lower-index"><i>m</i></sub>)|</span> took the minimum possible value. Here <span class="tex-span">|<i>p</i>|</span> denotes the length of the string <span class="tex-span"><i>p</i></span>.</p><p>Note that it is not allowed to change the relative order of lines in the subsequences. It is allowed to make one of the subsequences empty. Each string from the initial sequence should belong to exactly one subsequence. Elements of subsequences <span class="tex-span"><i>b</i></span> and <span class="tex-span"><i>c</i></span> don't have to be consecutive in the original sequence <span class="tex-span"><i>a</i></span>, i. e. elements of <span class="tex-span"><i>b</i></span> and <span class="tex-span"><i>c</i></span> can alternate in <span class="tex-span"><i>a</i></span> (see samples 2 and 3).</p><p>Help Valera to find the minimum possible value of <span class="tex-span"><i>S</i></span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input data contains an integer <span class="tex-span"><i>n</i></span> â€” the number of strings (<span class="tex-span">1â€‰â‰¤â€‰<i>n</i>â€‰â‰¤â€‰2Â·10<sup class="upper-index">5</sup></span>). Then on <span class="tex-span"><i>n</i></span> lines follow elements of the sequence â€” strings whose lengths are from <span class="tex-span">1</span> to <span class="tex-span">20</span> characters, consisting only of digits <span class="tex-span">0</span> and <span class="tex-span">1</span>. The <span class="tex-span"><i>i</i>â€‰+â€‰1</span>-th input line contains the <span class="tex-span"><i>i</i></span>-th element of the sequence. Elements of the sequence are separated only by a newline. It is guaranteed that all lines have the same length.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single number â€” the minimum possible value of <span class="tex-span"><i>S</i></span>.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3<br />01<br />10<br />01<br /></pre></div><div class="output"><div class="title">Output</div><pre>4<br /></pre></div><div class="input"><div class="title">Input</div><pre>4<br />000<br />111<br />110<br />001<br /></pre></div><div class="output"><div class="title">Output</div><pre>8<br /></pre></div><div class="input"><div class="title">Input</div><pre>5<br />10101<br />01010<br />11111<br />01000<br />10010<br /></pre></div><div class="output"><div class="title">Output</div><pre>17<br /></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Detailed answers to the tests:</p><p><ul> <li> The best option is to make one of the subsequences empty, and the second one equal to the whole given sequence. <span class="tex-span">|<i>f</i>(01,â€‰10,â€‰01)|â€‰=â€‰|<i>f</i>(<i>f</i>(01,â€‰10),â€‰01)|â€‰=â€‰|<i>f</i>(010,â€‰01)|â€‰=â€‰|0101|â€‰=â€‰4</span>. </li><li> The best option is: <span class="tex-span"><i>b</i>â€‰=â€‰{000,â€‰001},â€‰<i>c</i>â€‰=â€‰{111,â€‰110}.</span> <span class="tex-span"><i>S</i>â€‰=â€‰|<i>f</i>(000,â€‰001)|â€‰+â€‰|<i>f</i>(111,â€‰110)|â€‰=â€‰|0001|â€‰+â€‰|1110|â€‰=â€‰8</span>. </li><li> The best option is: <span class="tex-span"><i>b</i>â€‰=â€‰{10101,â€‰01010,â€‰01000},â€‰<i>c</i>â€‰=â€‰{11111,â€‰10010}.</span> <span class="tex-span"><i>S</i>â€‰=â€‰|10101000|â€‰+â€‰|111110010|â€‰=â€‰17</span>. </li></ul></p></div></div></div>            </div>
        </div>
          <br style="clear:both;"/> 
          <div id="footer">
               <div><a href="http://codeforces.com/">Codeforces</a> (c) Copyright 2010-2012 Mike Mirzayanov</div>
               <div>The only programming contests Web 2.0 platform</div>
               
               <div>Server time: 11/09/2012 12:27PM.</div>
          </div>
    <script type="text/javascript">
        $(document).ready(function() {
            Codeforces.focusOnError();
        });
    </script>
</div>    
</body>                                       
</html>                                       
